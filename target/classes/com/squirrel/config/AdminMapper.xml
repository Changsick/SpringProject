<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="AdminMapper">

	<select id="totalRecord" resultType="int">
		select count(*) from
		<if test="adminSelect == 'member'">
			memberList <include refid="memberSelect" /> </if> <!--<if test="adminSelect 
			== 'product'"> productList <include refid="productSelect" /> </if> <if test="adminSelect 
			== 'golfcc'"> GolfCC <include refid="golfCcSelect" /> </if> -->
	</select>
	<select id="adminGolfSelect" resultType="GolfCcDTO"
		parameterType="HashMap">
		select cc_id, cc_name, cc_addr1, cc_addr2, cc_phone, cc_url, cc_img
		from (select * from (select rownum rnum, g.* from golfcc g)
		<include refid="golfCcSelect" />
		)
		<include refid="rnum" />
	</select>
	<select id="adminMemberSelect" parameterType="HashMap"
		resultType="MemberDTO">
		select user_no,phone_id,userpw,username,nickname,userssn,gender,
		rating,to_char(rstartdate,'yyyy/MM/dd') rstartdate,
		to_char(renddate,'yyyy/MM/dd') renddate, email,email_chk from (select
		* from ( select rownum rnum, m.* from memberList m
		<if test="adminSearch != null"> where username like '%'||#{adminSearch}||'%' or phone_id
			like '%'||#{adminSearch}||'%' or nickname like
			'%'||#{adminSearch}||'%' order by username</if>
		)
		<include refid="rnum" />
	</select>
	<sql id="memberSelect">
		<if test="adminSearch == 'member'">
			where username like '%'||#{adminSearch}||'%' 
			or phone_id like '%'||#{adminSearch}||'%' 
			or nickname like '%'||#{adminSearch}||'%' 
			order by username
		</if>
	</sql>
	<sql id="golfCcSelect">
		<if test="adminSelect == 'golfcc'">
			where cc_name like '%'||#{adminSearch}||'%'
			or cc_addr2	like '%'||#{adminSearch}||'%'
			or cc_phone like '%'||#{adminSearch}||'%'
			or cc_url like '%'||#{adminSearch}||'%' 
			order by cc_name
		</if>
	</sql>
	<sql id="rnum">
		<![CDATA[ where rnum <= #{end} ) where rnum >= #{start} ]]>
	</sql>
</mapper>